# Chapter 08 서블릿 기초 문법  
## 1. 서블릿이란?  

- 서블릿은 Sun(사)에서 웹 프로그래밍(동적인 웹페이지 콘텐츠를 생성)을 제공하기 위해 JSP 이전에 나온 기술
- 서블릿의 자바 코드를 사용하기 때문에 자바의 많은 장점을 사용 가능한 반면, HTML, CSS및 자바 스크립트 그리고 웹 디자인과 연동하기에는 많은 단점이 있다. -> JSP를 만들었다.
- 단점이 많지만 서블릿의 존재 이유
  - JSP에는 없는 서버 측 프로그램의 기능
  - 대규모 프로젝트에 사용되는 프레임워크의 기술을 사용
### 1.1 이클립스로 서블릿 만들기  
```java
package ch08;
import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/ch08/exampleServlet01")                         // 서블릿 호출 될 이름을 선언한다.
public class ExampleServlet01 extends HttpServlet {           // 서블릿으로 만들기 위해서는 반드시 상속해야 하는 클래스이다.
@Override
  protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
  response.setContentType("text/html; charest=EUC-KR");       // 브라우저로 응답할 때의 타입과 캐릭터 셋을 결정한다.
  PrintWriter out = response.getWriter();                     // 브라우저에 출력하기 위한 스트림이다.
  //html 시작
  out.println("<html>");
  out.println("<body>");
  out.println("<h1>이클립스로 서블릿 만들기</h1>");
  out.println("</body>");
  out.println("</html>");
  //html 끝
  }
}
```

### 1.2 서블릿의 주요 클래스
1. HttpServlet
- 서블릿을 만들기 위해 반드시 상속해야 할 필수 클래스
- 존재 목적 자체가 서블릿을 만들기 위해 제공되는 클래스
> void init() : 서블릿의 객체가 생성될 때 호출되는 메서드
> 
> void destroy() : 서블릿의 객체가 메모리에서 사라질 때 호출되는 메서드
> 
> void service(request, response) : 서블릿의 요청이 있을 때 호출되는 메서드
> 
> void doGet(request, response) : html에서 form의 메서드가 get일 때 호출되는 메서드 
> 
> void doPost(request, response) : html에서 form의 메서드가 post일 때 호출되는 메서드


2. HttpServletRequest
- 클라이언트가 데이터를 입력하거나 또는 클라이언트에 대한 정보에 대한 요청 값을 가지고 있는 클래스
> String getParameter(name) : name에 할당된 값을 반환하며 지정된 파라미터 값이 없으면 null 값을 반환한다.
> 
> String[] getParaneterValues(name) : name의 모든 값을 String 배열로 반환한다.
> 
> Enumeration getParameterNames() : 요청에 사용된 모든 파라미터 이름을 java.util.Enumeration 타입으로 반환한다.
> 
> void setCharacterEncoding(env) : post 방식으로 요청된 문자열의 character encoding을 설정한다.

3. HttpServletResponse 
- 클라이언트가 요청한 정보를 처리하고 다시 응답하기 위한 정보를 담고 있는 클래스
> void setHeader(name, value) : 응답에 포함될 Header를 설정한다.
> 
> void setContentType(type) : 출력되는 페이지의 contentType을 설정한다.
> 
> String getCharacterEncoding() : 응답 페이지의 문자 인코딩 Type을 반환한다.
> 
> void sendRedirect(url) : 지정된 URL로 요청을 재전송한다.

4. HttpSession
- 클라이언트가 세션의 정보를 저장하고 세션 기능을 유지하기 위해서 제공되는 클래스
> String getId() : 해당 세션의 세션 ID를 반환한다.
> 
> long getCreationTime() : 세션의 생선된 시간을 반환한다.
> 
> long getLastAccessedTime() : 클라이언트 요청이 마지막으로 시도된 시간을 반환한다.
> 
> void setMaxInactiveInterval(time) : 세션을 유지할 시간을 초단위로 설정한다.
> 
> in getMaxInactiveInterval() : setMaxInactiveInterval(time)로 지정된 값을 반환한다. 기본값은 30분이다.
> 
> boolean isNew() : 클라이언트 세션 ID를 할당하지 않은 경우 true 값을 반환한다.
> 
> void invalidate() : 해당 세션을 종료 시킨다.

### 1.3 서블릿의 라이프 사이클  

서블릿은 클라이언트가 브라우저에서 서블릿으로 요청을 하면 해당 서블릿은 언제 객체가 만들어지고 언제 기존에 객체를 재활용하고 언제 종료가 되는지 다른 라이프 사이클이 존재한다.

- init() : 서블릿이 처음으로 요청이 되어 객체가 생성될 때 호출되는 메서드
- service() : 클라이언트가 요청이 있을 때 마다 호출되는 메서드
- destroy() : 서블릿 서비스의 종료 및 재시작 그리고 서블릿 코드가 수정이 될 때 호출되는 메서드
- doGet() : 클라이언트를 요청할 때 form의 메서드가 get 방식일 때 호출되는 메서드
- doPost() : 클라이언트를 요청할 때 form의 메서드가 post 방식일 때 호출되는 메서드

`클라이언트 서블릿 요청 -> init(최초 한 번 호출) -> service, doGet, doPost(반복적 호출) -> destroy(마지막 한 번 호출)`

```java
package ch08;

import java.io.IOException;...
@WebServlet("/ch08/exampleServlet02")       // 서블릿 맵핑 이름을 선언한다.
public class ExampleServlet02 extends HttpServlet {

  @Override
  public void init(ServletConfig config) throws ServletException {
    System.out.println("init 호출");        // 톰캣 서버 콘솔 화면에 출력을 한다.
  }
  @Override
  public void destroy() {
    System.out.println("destroy 호출");
  }
  @Override
  protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    System.out.println("service 호출");
  }
}
```

## 2. 서블릿의 요청 방식  
- 브라우저에서 페이지 간에 통신할 수 있는 대표적인 방법은 `get`, `post`방식이 있다.

### 2.1 get 방식  

URL을 통해서 전송되며, URL이 노출되기 때문에 보안적인 내용은 작성하면 안된다.
```java
<%@ page contectType="text/html; charset=EUC-KR"%>
<html>
<body>
<h1>Get Servlet 방식</h1>
<form method="get" action="getServlet">
msg : <input name="msg">
<input type="submit" value="전송">
</form>
</body>
</html>
```


































